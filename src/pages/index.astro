---
import { getCollection } from 'astro:content'
import { Button } from '@/components/ui/button'
import { SquareArrowRight } from 'lucide-react'

import MainLayout from '@/layouts/MainLayout.astro'
import PostCard from '@/components/post/post-card'
import MomentCard from '@/components/moment/moment-card'
import MainTitle from '@/components/title/main-title'
import JuheImagesAD from '@/components/ad/juheimages'
import TencentCloudAD from '@/components/ad/tencent-cloud-ad'

const posts = await getCollection('posts')
const moments = await getCollection('moments')

posts.sort((x, y) => {
  return y.data.pubDate.getTime() - x.data.pubDate.getTime()
})
const latestPosts = posts.slice(0, 5)

moments.sort((x, y) => {
  return y.data.pubDate.getTime() - x.data.pubDate.getTime()
})
const latestMoments = moments.slice(0, 3)

const title = 'è½ç§‹cc | é¦–é¡µ'
const banner = {
  title: 'Hi ! ğŸ‘‹',
  description: 'æ—©ä¸Šå¥½ï¼ä¸­åˆå¥½ï¼æ™šä¸Šå¥½ï¼',
}
---

<MainLayout title={title} banner={banner}>
  <MainTitle>æœ€æ–°åŠ¨æ€</MainTitle>
  <div class="my-4 grid grid-cols-1 gap-4 md:grid-cols-3">
    {
      latestMoments.map((moment) => (
        <MomentCard
          url={moment.data.url}
          title={moment.data.title}
          topics={moment.data.topic}
          pubDate={moment.data.pubDate}
          author={moment.data.author}
        >
          {moment.body}
        </MomentCard>
      ))
    }
  </div>

  <a href={'/moments'}>
    <Button>
      æ›´å¤šåŠ¨æ€ <SquareArrowRight />
    </Button>
  </a>

  <!-- AD -->
  <JuheImagesAD />

  <MainTitle>æœ€æ–°åšå®¢</MainTitle>
  <div class="my-4">
    {
      latestPosts.map((post) => (
        <PostCard
          title={post.data.title}
          description={post.data.description}
          id={post.id}
          tags={post.data.tags}
          pubDate={post.data.pubDate}
          author={post.data.author}
        />
      ))
    }
  </div>

  <a href={'/posts/1'}>
    <Button>
      æ›´å¤šåšå®¢ <SquareArrowRight />
    </Button>
  </a>

  <!-- AD -->
  <TencentCloudAD />
</MainLayout>
